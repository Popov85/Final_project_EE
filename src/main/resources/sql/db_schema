CREATE TABLE EMP_ROLE(
  R_ID BIGSERIAL PRIMARY KEY NOT NULL,
  R_NAME VARCHAR(50) NOT NULL UNIQUE
  );

CREATE TABLE EMP_POSITION(
  POS_ID BIGSERIAL PRIMARY KEY NOT NULL,
  POS_NAME VARCHAR(50) NOT NULL UNIQUE,
  R_ID BIGINT REFERENCES EMP_ROLE (R_ID) NOT NULL
  );

CREATE TABLE EMPLOYEE (
  EMP_ID BIGSERIAL PRIMARY KEY NOT NULL,
  EMP_LOGIN VARCHAR (25) NOT NULL UNIQUE,
  EMP_PASSWORD VARCHAR (60) NOT NULL UNIQUE,
  EMP_NAME VARCHAR(50) NOT NULL,
  DOB DATE NOT NULL,
  PHONE VARCHAR (15) NOT NULL UNIQUE,
  SALARY DOUBLE PRECISION NOT NULL,
  PHOTO BYTEA,
  POS_ID BIGINT REFERENCES EMP_POSITION (POS_ID) NOT NULL
  );

CREATE TABLE UNIT (
  U_ID BIGSERIAL PRIMARY KEY NOT NULL,
  U_NAME VARCHAR(10) NOT NULL UNIQUE
);

CREATE TABLE INGREDIENT (
  ING_ID BIGSERIAL PRIMARY KEY NOT NULL,
  ING_NAME VARCHAR(50) NOT NULL UNIQUE,
  UNIT_ID BIGINT REFERENCES UNIT (U_ID) NOT NULL
  );

CREATE TABLE DISH (
  D_ID BIGSERIAL PRIMARY KEY NOT NULL,
  DISH_NAME VARCHAR(50) NOT NULL UNIQUE,
  CATEGORY VARCHAR (50) NOT NULL,
  PRICE DOUBLE PRECISION NOT NULL,
  WEIGHT DOUBLE PRECISION NOT NULL
  );

CREATE TABLE DISH_INGREDIENT (
  D_ID BIGINT REFERENCES DISH (D_ID),
  ING_ID BIGINT REFERENCES INGREDIENT (ING_ID),
  QUANTITY DOUBLE PRECISION NOT NULL,
  PRIMARY KEY (D_ID, ING_ID)
  );

CREATE TABLE ORDERS (
  ORD_ID BIGSERIAL PRIMARY KEY NOT NULL,
  IS_OPENED BOOLEAN NOT NULL,
  IS_CANCELLED BOOLEAN NOT NULL,
  OPEN_DATE TIMESTAMP NOT NULL,
  CLOSE_DATE TIMESTAMP,
  TABLE_NUMBER VARCHAR(25) NOT NULL,
  EMP_ID BIGINT REFERENCES EMPLOYEE (EMP_ID)
  );

  CREATE TABLE ORDER_DISH (
  ORD_ID BIGINT REFERENCES ORDERS (ORD_ID),
  D_ID BIGINT REFERENCES DISH (D_ID),
  QUANTITY SMALLINT NOT NULL,
  PRIMARY KEY (ORD_ID, D_ID)
  );

CREATE TABLE MENU (
  M_ID BIGSERIAL PRIMARY KEY NOT NULL,
  MENU_NAME VARCHAR(50) NOT NULL UNIQUE
  );

CREATE TABLE MENU_DISH (
  M_ID BIGINT REFERENCES MENU (M_ID),
  D_ID BIGINT REFERENCES DISH (D_ID),
  PRIMARY KEY (M_ID, D_ID)
  );

CREATE TABLE STORE_HOUSE (
  ING_ID BIGINT PRIMARY KEY REFERENCES INGREDIENT (ING_ID),
  QUANTITY DOUBLE PRECISION NOT NULL
  );

CREATE TABLE PREPARED_DISH (
  PD_ID SERIAL PRIMARY KEY NOT NULL,
  WHEN_PREPARED TIMESTAMP,
  D_ID INTEGER REFERENCES DISH (D_ID) NOT NULL,
  CHEF_ID INTEGER REFERENCES EMPLOYEE (EMP_ID),
  ORD_ID INTEGER REFERENCES ORDERS (ORD_ID) NOT NULL,
  IS_CANCELLED BOOLEAN NOT NULL
  );